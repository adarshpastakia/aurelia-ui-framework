{"version":3,"file":"ui-tab-panel.js","sources":["../../src/tab-panel/ui-tab.ts","../../src/tab-panel/ui-tab-end.ts","../../src/tab-panel/ui-tab-start.ts","../../src/tab-panel/ui-tab-panel.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { bindable, customElement, inlineView } from \"aurelia-framework\";\n\nlet tabSeed = 0;\n\n@customElement(\"ui-tab\")\n@inlineView(\n  `<template class=\"ui-tab\" data-active.bind=\"active\" data-hide.bind=\"!!view || !!viewModel\"><slot></slot></template>`\n)\nexport class UITab {\n  @bindable()\n  public id: string = \"\";\n  @bindable()\n  public label: string = \"\";\n  @bindable()\n  public icon: string = \"\";\n  @bindable()\n  public active: boolean = false;\n  @bindable()\n  public disabled: boolean = false;\n\n  @bindable()\n  public view: AnyObject;\n  @bindable()\n  public model: AnyObject;\n  @bindable()\n  public viewModel: AnyObject;\n\n  @bindable()\n  public closeable: boolean = false;\n\n  constructor(protected element: Element) {\n    this.id = `tab__${tabSeed++}`;\n  }\n\n  protected bind() {\n    this.closeable = !isFalse(this.closeable)\n  }\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-end\")\n@inlineView(`<template><div slot=\"tabbar-end\"><slot></slot></div></template>`)\nexport class UITabbarEnd {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-start\")\n@inlineView(`<template><div slot=\"tabbar-start\"><slot></slot></div></template>`)\nexport class UITabbarStart {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport {\n  autoinject,\n  bindable,\n  bindingMode,\n  children,\n  customElement,\n  DOM,\n  inlineView,\n  View\n} from \"aurelia-framework\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { UIInternal } from \"../utils/ui-internal\";\nimport { UITab } from \"./ui-tab\";\nimport { UITabbarEnd } from \"./ui-tab-end\";\nimport view from \"./ui-tab-panel.html\";\nimport { UITabbarStart } from \"./ui-tab-start\";\n\nexport interface UITabConfig {\n  id?: string;\n  icon?: string;\n  label?: string;\n  tooltip?: string;\n  active?: boolean;\n  disabled?: boolean;\n  closeable?: boolean;\n\n  href?: string;\n  view?: AnyObject;\n  model?: AnyObject;\n  element?: AnyObject;\n  viewModel?: AnyObject;\n}\n@autoinject()\n@customElement(\"ui-tab-panel\")\n@inlineView(view)\nclass UITabPanel {\n  @bindable()\n  public tabs: UITabConfig[] = [];\n  @bindable({ bindingMode: bindingMode.twoWay })\n  public active: string;\n\n  @bindable()\n  public align: \"top\" | \"bottom\" = \"top\";\n\n  @bindable()\n  public beforechange: () => Promise<boolean> | boolean;\n  @bindable()\n  public beforeclose: () => Promise<boolean> | boolean;\n\n  @children(\"ui-tab\")\n  protected innerTabs: UITabConfig[];\n\n  @bindable({ bindingMode: bindingMode.toView })\n  protected activeTab: UITabConfig;\n\n  private owningView: AnyObject;\n  private composeVm: AnyObject;\n\n  private wrapperEl: Element;\n  private overflowEl: Element;\n\n  private hasOverflow: boolean = false;\n  private obResize: ResizeObserver;\n\n  private isAttached: boolean = false;\n\n  constructor(protected element: Element) {\n    if (element.hasAttribute(\"no-border\")) {\n      element.classList.add(\"ui-tab__panel--noborder\");\n    }\n    this.obResize = new ResizeObserver(() => this.calculateOverflow());\n    this.obResize.observe(element);\n  }\n\n  public async activateTab(id: string): Promise<boolean> {\n    const tab = this.tabs.find(t => t.id === id);\n\n    let result = true;\n    if (this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforechange\", {\n        activeTab: this.activeTab.id,\n        activeViewModel: this.composeVm.currentViewModel,\n        newTab: id\n      }).then(b => (b ? this.activate(id) : undefined));\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  public async closeTab(id: string): Promise<boolean> {\n    const tab = this.tabs.find(t => t.id === id);\n\n    let result = true;\n    if (this.activeTab.id === id && this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforeclose\", tab.id).then(b =>\n        b ? this.remove(id) : false\n      );\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  // Set current owningView\n  protected created(owningView: View) {\n    this.owningView = owningView;\n  }\n\n  // Update compose owningView and viewResource to current owningView\n  protected attached(): void {\n    this.composeVm.owningView = this.owningView;\n    this.composeVm.viewResources = this.owningView.resources;\n    setTimeout(() => this.calculateOverflow(), 200);\n\n    this.isAttached = true;\n    this.tabsChanged();\n  }\n\n  protected detached(): void {\n    this.obResize.disconnect();\n  }\n\n  protected innerTabsChanged(): void {\n    this.tabs = this.innerTabs || this.tabs;\n    this.tabsChanged();\n  }\n\n  protected tabsChanged(): void {\n    if (this.isAttached) {\n      this.active = (this.tabs.find(tab => tab.active) || {}).id;\n      if (!this.active) {\n        this.activeTab = this.tabs.find(tab => !tab.disabled) || {};\n        this.active = this.activeTab.id;\n        this.activeTab.active = true;\n      }\n    }\n  }\n\n  protected activate(id: string): boolean {\n    const newTab = this.tabs.find(tab => tab.id === id);\n    if (newTab) {\n      this.element.dispatchEvent(UIInternal.createEvent(\"change\", id));\n\n      if (this.activeTab) {\n        this.activeTab.active = false;\n      }\n      this.activeTab = newTab;\n      this.active = this.activeTab.id;\n      this.activeTab.active = true;\n      return true;\n    }\n    return false;\n  }\n\n  protected remove(id: string): boolean {\n    const tab = this.tabs.find(t => t.id === id);\n    this.element.dispatchEvent(UIInternal.createEvent(\"close\", id));\n    this.tabs.splice(this.tabs.indexOf(tab), 1);\n    if (tab.element) {\n      UIInternal.queueTask(() => DOM.removeNode(tab.element));\n    }\n    return true;\n  }\n\n  protected calculateOverflow(): void {\n    this.resetOverflow();\n    const overflowItems = [];\n    const isRtl = window.getComputedStyle(this.wrapperEl).direction === \"rtl\";\n    // @ts-ignore\n    [...this.wrapperEl.children].reverse().forEach(item => {\n      if (\n        (!isRtl && this.wrapperEl.offsetWidth - (item.offsetLeft + item.offsetWidth) <= 30) ||\n        (isRtl && this.wrapperEl.offsetWidth - item.offsetLeft >= this.wrapperEl.offsetWidth - 30)\n      ) {\n        overflowItems.splice(0, 0, item);\n        this.hasOverflow = true;\n      }\n    });\n    this.overflowEl.append(...overflowItems);\n  }\n\n  protected resetOverflow(): void {\n    this.hasOverflow = false;\n    this.overflowEl.children.forEach(child => {\n      this.wrapperEl.appendChild(child);\n    });\n  }\n}\n\nexport const TabPanel = [UITabPanel, UITab, UITabbarStart, UITabbarEnd];\n"],"names":["tslib_1.__decorate"],"mappings":"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"}