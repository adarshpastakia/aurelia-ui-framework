{"version":3,"file":"ui-internal.js","sources":["../../src/utils/ui-internal.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { EventAggregator, Subscription } from \"aurelia-event-aggregator\";\nimport {\n  BindingEngine,\n  Container,\n  DOM,\n  Task,\n  TaskQueue,\n  View,\n  ViewCompiler,\n  ViewResources\n} from \"aurelia-framework\";\n\nexport namespace UIInternal {\n  export const EVT_VIEWPORT_CLICK = \"EVT_VIEWPORT_CLICK\";\n  export const EVT_VIEWPORT_RESIZE = \"EVT_VIEWPORT_RESIZE\";\n\n  // Task queue shortcut\n  export function queueTask(task: () => AnyObject | Task): void {\n    Container.instance.get(TaskQueue).queueTask(task);\n  }\n  export function queueMicroTask(task: () => AnyObject | Task): void {\n    Container.instance.get(TaskQueue).queueMicroTask(task);\n  }\n\n  // Event aggregation shortcut\n  export function broadcast(name: string, data?: AnyObject): void {\n    Container.instance.get(EventAggregator).publish(name, data);\n  }\n  export function subscribe(name: string, callback: AnyObject): Subscription {\n    return Container.instance.get(EventAggregator).subscribe(name, callback);\n  }\n  export function subscribeOnce(name: string, callback: AnyObject): Subscription {\n    return Container.instance.get(EventAggregator).subscribeOnce(name, callback);\n  }\n  export function observe(data: AnyObject, property: string, callback: AnyObject): Subscription {\n    return Container.instance\n      .get(BindingEngine)\n      .observe(data, property)\n      .subscribe(callback);\n  }\n\n  export function createEvent<T = {}>(name: string, data?: T): CustomEvent {\n    return DOM.createCustomEvent(name, {\n      bubbles: true,\n      cancelable: true,\n      detail: data\n    });\n  }\n\n  export function fireCallbackEvent(\n    vm: AnyObject,\n    event: string,\n    data?: AnyObject\n  ): Promise<boolean> {\n    const ret = isFunction(vm[event])\n      ? vm[event](data)\n      : vm.element.dispatchEvent(UIInternal.createEvent(event, data));\n    if (ret instanceof Promise) {\n      return ret;\n    } else {\n      return Promise.resolve(ret !== false);\n    }\n  }\n\n  export function invokeLifecycle(instance, name, model?): Promise<AnyObject> {\n    if (instance && typeof instance[name] === \"function\") {\n      const result = instance[name](model);\n      if (result instanceof Promise) {\n        return result;\n      }\n      if (result !== null && result !== undefined) {\n        return Promise.resolve(result);\n      }\n      return Promise.resolve(true);\n    }\n    return Promise.resolve(true);\n  }\n\n  export function compileTemplate(tpl: string, viewModel: AnyObject = {}, bindingContext = {}): View {\n    const viewFactory = Container.instance\n      .get(ViewCompiler)\n      .compile(tpl, Container.instance.get(ViewResources));\n    const view = viewFactory.create(Container.instance);\n    view.bind(viewModel, bindingContext);\n    return view;\n  }\n}\n"],"names":[],"mappings":"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"}