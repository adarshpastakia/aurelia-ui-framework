{"version":3,"file":"ui-tab-panel.js","sources":["../../src/tab-panel/ui-tab.ts","../../src/tab-panel/ui-tab-end.ts","../../src/tab-panel/ui-tab-start.ts","../../src/tab-panel/ui-tab-panel.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { bindable, customElement, inlineView } from \"aurelia-framework\";\n\nlet tabSeed = 0;\n\n@customElement(\"ui-tab\")\n@inlineView(\n  `<template class=\"ui-tab\" data-active.bind=\"active\" data-hide.bind=\"!!view || !!viewModel\"><slot></slot></template>`\n)\nexport class UITab {\n  @bindable()\n  public id: string = \"\";\n  @bindable()\n  public label: string = \"\";\n  @bindable()\n  public icon: string = \"\";\n  @bindable()\n  public active: boolean = false;\n  @bindable()\n  public disabled: boolean = false;\n\n  @bindable()\n  public view: AnyObject;\n  @bindable()\n  public model: AnyObject;\n  @bindable()\n  public viewModel: AnyObject;\n\n  @bindable()\n  public closeable: boolean = false;\n\n  constructor(protected element: Element) {\n    this.id = `tab__${tabSeed++}`;\n  }\n\n  protected bind() {\n    this.closeable = !isFalse(this.closeable)\n  }\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-end\")\n@inlineView(`<template><div slot=\"tabbar-end\"><slot></slot></div></template>`)\nexport class UITabbarEnd {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-start\")\n@inlineView(`<template><div slot=\"tabbar-start\"><slot></slot></div></template>`)\nexport class UITabbarStart {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport {\n  autoinject,\n  bindable,\n  bindingMode,\n  children,\n  customElement,\n  DOM,\n  inlineView,\n  View\n} from \"aurelia-framework\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { UIInternal } from \"../utils/ui-internal\";\nimport { UITab } from \"./ui-tab\";\nimport { UITabbarEnd } from \"./ui-tab-end\";\nimport view from \"./ui-tab-panel.html\";\nimport { UITabbarStart } from \"./ui-tab-start\";\n\nexport interface UITabConfig {\n  id?: string;\n  icon?: string;\n  label?: string;\n  tooltip?: string;\n  active?: boolean;\n  disabled?: boolean;\n  closeable?: boolean;\n\n  href?: string;\n  view?: AnyObject;\n  model?: AnyObject;\n  element?: AnyObject;\n  viewModel?: AnyObject;\n}\n@autoinject()\n@customElement(\"ui-tab-panel\")\n@inlineView(view)\nclass UITabPanel {\n  @bindable()\n  public tabs: UITabConfig[] = [];\n  @bindable({ bindingMode: bindingMode.twoWay })\n  public active: string;\n\n  @bindable()\n  public align: \"top\" | \"bottom\" = \"top\";\n\n  @bindable()\n  public beforechange: () => Promise<boolean> | boolean;\n  @bindable()\n  public beforeclose: () => Promise<boolean> | boolean;\n\n  @children(\"ui-tab\")\n  protected innerTabs: UITabConfig[];\n\n  @bindable({ bindingMode: bindingMode.toView })\n  protected activeTab: UITabConfig;\n\n  private owningView: AnyObject;\n  private composeVm: AnyObject;\n\n  private wrapperEl: Element;\n  private overflowEl: Element;\n\n  private hasOverflow: boolean = false;\n  private obResize: ResizeObserver;\n\n  private isAttached: boolean = false;\n\n  constructor(protected element: Element) {\n    if (element.hasAttribute(\"no-border\")) {\n      element.classList.add(\"ui-tab__panel--noborder\");\n    }\n    this.obResize = new ResizeObserver(() => this.calculateOverflow());\n    this.obResize.observe(element);\n  }\n\n  public async activateTab(id: string): Promise<boolean> {\n    let result = true;\n    if (this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforechange\", {\n        activeTab: this.activeTab.id,\n        activeViewModel: this.composeVm.currentViewModel,\n        newTab: id\n      }).then(b => (b ? this.activate(id) : undefined));\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  public async closeTab(id: string): Promise<boolean> {\n    const tab = this.tabs.find(t => t.id === id);\n\n    let result = true;\n    if (this.activeTab.id === id && this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforeclose\", tab.id).then(b =>\n        b ? this.remove(id) : false\n      );\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  // Set current owningView\n  protected created(owningView: View) {\n    this.owningView = owningView;\n  }\n\n  // Update compose owningView and viewResource to current owningView\n  protected attached(): void {\n    this.composeVm.owningView = this.owningView;\n    this.composeVm.viewResources = this.owningView.resources;\n    setTimeout(() => this.calculateOverflow(), 200);\n\n    this.isAttached = true;\n    this.tabsChanged();\n  }\n\n  protected detached(): void {\n    this.obResize.disconnect();\n  }\n\n  protected innerTabsChanged(): void {\n    this.tabs = this.innerTabs || this.tabs;\n    this.tabsChanged();\n  }\n\n  protected tabsChanged(): void {\n    if (this.isAttached) {\n      this.active = (this.tabs.find(tab => tab.active) || {}).id;\n      if (!this.active) {\n        this.activeTab = this.tabs.find(tab => !tab.disabled) || {};\n        this.active = this.activeTab.id;\n        this.activeTab.active = true;\n      }\n    }\n  }\n\n  protected activate(id: string): boolean {\n    const newTab = this.tabs.find(tab => tab.id === id);\n    if (newTab) {\n      this.element.dispatchEvent(UIInternal.createEvent(\"change\", id));\n\n      if (this.activeTab) {\n        this.activeTab.active = false;\n      }\n      this.activeTab = newTab;\n      this.active = this.activeTab.id;\n      this.activeTab.active = true;\n      return true;\n    }\n    return false;\n  }\n\n  protected remove(id: string): boolean {\n    const tab = this.tabs.find(t => t.id === id);\n    this.element.dispatchEvent(UIInternal.createEvent(\"close\", id));\n    this.tabs.splice(this.tabs.indexOf(tab), 1);\n    if (tab.element) {\n      UIInternal.queueTask(() => DOM.removeNode(tab.element));\n    }\n    return true;\n  }\n\n  protected calculateOverflow(): void {\n    this.resetOverflow();\n    const overflowItems = [];\n    const isRtl = window.getComputedStyle(this.wrapperEl).direction === \"rtl\";\n    // @ts-ignore\n    [...this.wrapperEl.children].reverse().forEach(item => {\n      if (\n        (!isRtl && this.wrapperEl.offsetWidth - (item.offsetLeft + item.offsetWidth) <= 30) ||\n        (isRtl && this.wrapperEl.offsetWidth - item.offsetLeft >= this.wrapperEl.offsetWidth - 30)\n      ) {\n        overflowItems.splice(0, 0, item);\n        this.hasOverflow = true;\n      }\n    });\n    this.overflowEl.append(...overflowItems);\n  }\n\n  protected resetOverflow(): void {\n    this.hasOverflow = false;\n    this.overflowEl.children.forEach(child => {\n      this.wrapperEl.appendChild(child);\n    });\n  }\n}\n\nexport const TabPanel = [UITabPanel, UITab, UITabbarStart, UITabbarEnd];\n"],"names":["tslib_1.__decorate","tslib_1.__spread"],"mappings":"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"}