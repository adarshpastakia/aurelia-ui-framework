{"version":3,"file":"input-wrapper.js","sources":["../../src/forms/base-input.ts","../../src/forms/input-wrapper.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { computedFrom } from \"aurelia-framework\";\nimport { UIDrop } from \"../shared/ui-drop\";\nimport { UIInternal } from \"../utils/ui-internal\";\n\nexport class BaseInput {\n  public value: AnyObject;\n\n  protected inputEl: HTMLInputElement | HTMLTextAreaElement;\n\n  protected errors: string | string[];\n  protected maxlength: number = 0;\n  protected allowClear: boolean = false;\n  protected showCounter: boolean = false;\n\n  protected readonly: string | boolean = false;\n  protected disabled: string | boolean = false;\n  protected isDisabled: string | boolean = false;\n\n  protected dropHandle: string;\n  protected dropEl: UIDrop;\n\n  constructor(protected element: Element) {\n    this.allowClear = element.hasAttribute(\"clear\") || element.hasAttribute(\"clear.trigger\");\n    this.showCounter = element.hasAttribute(\"counter\");\n  }\n\n  public focus() {\n    this.inputEl.focus();\n  }\n\n  public disable(b: boolean): void {\n    this.isDisabled = b;\n  }\n\n  @computedFrom(\"isDisabled\", \"disabled\", \"readonly\", \"errors\", \"errors.length\")\n  get classes(): string {\n    const classes = [];\n    if (this.errors && this.errors.length > 0) {\n      classes.push(\"ui-input--invalid\");\n    }\n    if (this.isTrue(\"readonly\")) {\n      classes.push(\"ui-input--readonly\");\n    }\n    if (this.isTrue(\"disabled\") || this.isDisabled) {\n      classes.push(\"ui-input--disabled\");\n    }\n    return classes.join(\" \");\n  }\n\n  protected bind(): void {\n    this.readonly = this.isTrue(\"readonly\");\n    this.disabled = this.isTrue(\"disabled\");\n  }\n\n  protected clear(): void {\n    this.value = \"\";\n    this.inputEl.focus();\n    this.element.dispatchEvent(UIInternal.createEvent(\"clear\"));\n    this.element.dispatchEvent(UIInternal.createEvent(\"change\"));\n  }\n\n  protected fireEnter($event: KeyboardEvent): boolean {\n    if ($event.keyCode === 13) {\n      $event.stopEvent();\n      this.element.dispatchEvent(UIInternal.createEvent(\"enterpressed\", this.value));\n    }\n    return true;\n  }\n\n  protected canToggleDrop(evt: FocusEvent): void {\n    if (evt.relatedTarget && evt.relatedTarget !== this.inputEl) {\n      this.toggleDrop(false);\n    }\n  }\n\n  protected toggleDrop(open?: boolean): boolean {\n    if (open === true && this.dropEl.isOpen) {\n      UIInternal.queueMicroTask(() => this.dropEl.updatePosition());\n      return;\n    }\n    const beforeEvent = this.dropEl.isOpen && !open ? \"beforeclose\" : \"beforeopen\";\n    const afterEvent = this.dropEl.isOpen && !open ? \"close\" : \"open\";\n    if (this.element.dispatchEvent(UIInternal.createEvent(beforeEvent)) !== false) {\n      this.dropEl.toggleDrop(open);\n      this.element.dispatchEvent(UIInternal.createEvent(afterEvent));\n      if (this.dropEl.isOpen) {\n        this.inputEl.select();\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }\n\n  private isTrue(prop: string): boolean {\n    return this[prop] === \"\" || this[prop] === prop || isTrue(this[prop]);\n  }\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, inlineView, processContent } from \"aurelia-framework\";\nimport view from \"./input-wrapper.html\";\n\n@containerless()\n@inlineView(view)\n@processContent((compiler, resources, node, instruction) => {\n  instruction.inheritBindingContext = true;\n  return true;\n})\nexport class InputWrapper {}\n"],"names":[],"mappings":"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"}