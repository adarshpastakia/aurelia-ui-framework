{"version":3,"file":"ui-tab-panel.js","sources":["../../src/tab-panel/ui-tab.ts","../../src/tab-panel/ui-tab-end.ts","../../src/tab-panel/ui-tab-start.ts","../../src/tab-panel/ui-tab-panel.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { bindable, customElement, inlineView } from \"aurelia-framework\";\n\nlet tabSeed = 0;\n\n@customElement(\"ui-tab\")\n@inlineView(\n  `<template class=\"ui-tab\" data-active.bind=\"active\" data-hide.bind=\"!!view || !!viewModel\"><slot></slot></template>`\n)\nexport class UITab {\n  @bindable()\n  public id: string = \"\";\n  @bindable()\n  public label: string = \"\";\n  @bindable()\n  public icon: string = \"\";\n  @bindable()\n  public active: boolean = false;\n  @bindable()\n  public disabled: boolean = false;\n\n  @bindable()\n  public view: AnyObject;\n  @bindable()\n  public model: AnyObject;\n  @bindable()\n  public viewModel: AnyObject;\n\n  @bindable()\n  public closeable: boolean = false;\n\n  constructor(protected element: Element) {\n    this.id = `tab__${tabSeed++}`;\n  }\n\n  protected bind() {\n    this.closeable = !isFalse(this.closeable)\n  }\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-end\")\n@inlineView(`<template><div slot=\"tabbar-end\"><slot></slot></div></template>`)\nexport class UITabbarEnd {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-start\")\n@inlineView(`<template><div slot=\"tabbar-start\"><slot></slot></div></template>`)\nexport class UITabbarStart {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport {\n  autoinject,\n  bindable,\n  bindingMode,\n  children,\n  customElement,\n  DOM,\n  inlineView,\n  View\n} from \"aurelia-framework\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { UIInternal } from \"../utils/ui-internal\";\nimport { UITab } from \"./ui-tab\";\nimport { UITabbarEnd } from \"./ui-tab-end\";\nimport view from \"./ui-tab-panel.html\";\nimport { UITabbarStart } from \"./ui-tab-start\";\n\nexport interface UITabConfig {\n  id?: string;\n  icon?: string;\n  label?: string;\n  tooltip?: string;\n  active?: boolean;\n  disabled?: boolean;\n  closeable?: boolean;\n\n  href?: string;\n  view?: AnyObject;\n  model?: AnyObject;\n  element?: AnyObject;\n  viewModel?: AnyObject;\n}\n@autoinject()\n@customElement(\"ui-tab-panel\")\n@inlineView(view)\nclass UITabPanel {\n  @bindable()\n  public tabs: UITabConfig[] = [];\n  @bindable({ bindingMode: bindingMode.twoWay })\n  public active: string;\n\n  @bindable()\n  public align: \"top\" | \"bottom\" = \"top\";\n\n  @bindable()\n  public beforechange: () => Promise<boolean> | boolean;\n  @bindable()\n  public beforeclose: () => Promise<boolean> | boolean;\n\n  @children(\"ui-tab\")\n  protected innerTabs: UITabConfig[];\n\n  @bindable({ bindingMode: bindingMode.toView })\n  protected activeTab: UITabConfig;\n\n  private owningView: AnyObject;\n  private composeVm: AnyObject;\n\n  private wrapperEl: Element;\n  private overflowEl: Element;\n\n  private hasOverflow: boolean = false;\n  private obResize: ResizeObserver;\n\n  private isAttached: boolean = false;\n\n  constructor(protected element: Element) {\n    if (element.hasAttribute(\"no-border\")) {\n      element.classList.add(\"ui-tab__panel--noborder\");\n    }\n    this.obResize = new ResizeObserver(() => this.calculateOverflow());\n    this.obResize.observe(element);\n  }\n\n  public async activateTab(id: string): Promise<boolean> {\n    let result = true;\n    if (this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforechange\", {\n        activeTab: this.activeTab.id,\n        activeViewModel: this.composeVm.currentViewModel,\n        newTab: id\n      }).then(b => (b ? this.activate(id) : undefined));\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  public async closeTab(id: string): Promise<boolean> {\n    const tab = this.tabs.find(t => t.id === id);\n\n    let result = true;\n    if (this.activeTab.id === id && this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforeclose\", tab.id).then(b =>\n        b ? this.remove(id) : false\n      );\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  // Set current owningView\n  protected created(owningView: View) {\n    this.owningView = owningView;\n  }\n\n  // Update compose owningView and viewResource to current owningView\n  protected attached(): void {\n    this.composeVm.owningView = this.owningView;\n    this.composeVm.viewResources = this.owningView.resources;\n    setTimeout(() => this.calculateOverflow(), 200);\n\n    this.isAttached = true;\n    this.tabsChanged();\n  }\n\n  protected detached(): void {\n    this.obResize.disconnect();\n  }\n\n  protected innerTabsChanged(): void {\n    this.tabs = this.innerTabs || this.tabs;\n    this.tabsChanged();\n  }\n\n  protected tabsChanged(): void {\n    if (this.isAttached) {\n      this.active = (this.tabs.find(tab => tab.active) || {}).id;\n      if (!this.active) {\n        this.activeTab = this.tabs.find(tab => !tab.disabled) || {};\n        this.active = this.activeTab.id;\n        this.activeTab.active = true;\n      }\n    }\n  }\n\n  protected activate(id: string): boolean {\n    const newTab = this.tabs.find(tab => tab.id === id);\n    if (newTab) {\n      this.element.dispatchEvent(UIInternal.createEvent(\"change\", id));\n\n      if (this.activeTab) {\n        this.activeTab.active = false;\n      }\n      this.activeTab = newTab;\n      this.active = this.activeTab.id;\n      this.activeTab.active = true;\n      return true;\n    }\n    return false;\n  }\n\n  protected remove(id: string): boolean {\n    const tab = this.tabs.find(t => t.id === id);\n    this.element.dispatchEvent(UIInternal.createEvent(\"close\", id));\n    this.tabs.splice(this.tabs.indexOf(tab), 1);\n    if (tab.element) {\n      UIInternal.queueTask(() => DOM.removeNode(tab.element));\n    }\n    return true;\n  }\n\n  protected calculateOverflow(): void {\n    this.resetOverflow();\n    const overflowItems = [];\n    const isRtl = window.getComputedStyle(this.wrapperEl).direction === \"rtl\";\n    // @ts-ignore\n    [...this.wrapperEl.children].reverse().forEach(item => {\n      if (\n        (!isRtl && this.wrapperEl.offsetWidth - (item.offsetLeft + item.offsetWidth) <= 30) ||\n        (isRtl && this.wrapperEl.offsetWidth - item.offsetLeft >= this.wrapperEl.offsetWidth - 30)\n      ) {\n        overflowItems.splice(0, 0, item);\n        this.hasOverflow = true;\n      }\n    });\n    this.overflowEl.append(...overflowItems);\n  }\n\n  protected resetOverflow(): void {\n    this.hasOverflow = false;\n    this.overflowEl.children.forEach(child => {\n      this.wrapperEl.appendChild(child);\n    });\n  }\n}\n\nexport const TabPanel = [UITabPanel, UITab, UITabbarStart, UITabbarEnd];\n"],"names":["tslib_1.__decorate","tslib_1.__spread"],"mappings":"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"}