{"version":3,"file":"ui-internal.js","sources":["../../src/utils/ui-internal.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { EventAggregator, Subscription } from \"aurelia-event-aggregator\";\nimport {\n  BindingEngine,\n  Container,\n  DOM,\n  Task,\n  TaskQueue,\n  View,\n  ViewCompiler,\n  ViewResources\n} from \"aurelia-framework\";\n\nexport namespace UIInternal {\n  export const EVT_VIEWPORT_CLICK = \"EVT_VIEWPORT_CLICK\";\n  export const EVT_VIEWPORT_RESIZE = \"EVT_VIEWPORT_RESIZE\";\n\n  // Task queue shortcut\n  export function queueTask(task: () => AnyObject | Task): void {\n    Container.instance.get(TaskQueue).queueTask(task);\n  }\n  export function queueMicroTask(task: () => AnyObject | Task): void {\n    Container.instance.get(TaskQueue).queueMicroTask(task);\n  }\n\n  // Event aggregation shortcut\n  export function broadcast(name: string, data?: AnyObject): void {\n    Container.instance.get(EventAggregator).publish(name, data);\n  }\n  export function subscribe(name: string, callback: AnyObject): Subscription {\n    return Container.instance.get(EventAggregator).subscribe(name, callback);\n  }\n  export function subscribeOnce(name: string, callback: AnyObject): Subscription {\n    return Container.instance.get(EventAggregator).subscribeOnce(name, callback);\n  }\n  export function observe(data: AnyObject, property: string, callback: AnyObject): Subscription {\n    return Container.instance\n      .get(BindingEngine)\n      .observe(data, property)\n      .subscribe(callback);\n  }\n\n  export function createEvent<T = {}>(name: string, data?: T): CustomEvent {\n    return DOM.createCustomEvent(name, {\n      bubbles: true,\n      cancelable: true,\n      detail: data\n    });\n  }\n\n  export function fireCallbackEvent(\n    vm: AnyObject,\n    event: string,\n    data?: AnyObject\n  ): Promise<boolean> {\n    const ret = isFunction(vm[event])\n      ? vm[event](data)\n      : vm.element.dispatchEvent(UIInternal.createEvent(event, data));\n    if (ret instanceof Promise) {\n      return ret;\n    } else {\n      return Promise.resolve(ret !== false);\n    }\n  }\n\n  export function invokeLifecycle(instance, name, model?): Promise<AnyObject> {\n    if (instance && typeof instance[name] === \"function\") {\n      const result = instance[name](model);\n      if (result instanceof Promise) {\n        return result;\n      }\n      if (result !== null && result !== undefined) {\n        return Promise.resolve(result);\n      }\n      return Promise.resolve(true);\n    }\n    return Promise.resolve(true);\n  }\n\n  export function compileTemplate(tpl: string, viewModel: AnyObject = {}, bindingContext = {}): View {\n    const viewFactory = Container.instance\n      .get(ViewCompiler)\n      .compile(tpl, Container.instance.get(ViewResources));\n    const view = viewFactory.create(Container.instance);\n    view.bind(viewModel, bindingContext);\n    return view;\n  }\n}\n"],"names":[],"mappings":"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"}