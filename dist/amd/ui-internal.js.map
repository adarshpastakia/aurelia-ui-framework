{"version":3,"file":"ui-internal.js","sources":["../../src/utils/ui-internal.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { EventAggregator, Subscription } from \"aurelia-event-aggregator\";\nimport {\n  BindingEngine,\n  Container,\n  DOM,\n  Task,\n  TaskQueue,\n  View,\n  ViewCompiler,\n  ViewResources\n} from \"aurelia-framework\";\n\nexport namespace UIInternal {\n  export const EVT_VIEWPORT_CLICK = \"EVT_VIEWPORT_CLICK\";\n  export const EVT_VIEWPORT_RESIZE = \"EVT_VIEWPORT_RESIZE\";\n\n  // Task queue shortcut\n  export function queueTask(task: () => AnyObject | Task): void {\n    Container.instance.get(TaskQueue).queueTask(task);\n  }\n  export function queueMicroTask(task: () => AnyObject | Task): void {\n    Container.instance.get(TaskQueue).queueMicroTask(task);\n  }\n\n  // Event aggregation shortcut\n  export function broadcast(name: string, data?: AnyObject): void {\n    Container.instance.get(EventAggregator).publish(name, data);\n  }\n  export function subscribe(name: string, callback: AnyObject): Subscription {\n    return Container.instance.get(EventAggregator).subscribe(name, callback);\n  }\n  export function subscribeOnce(name: string, callback: AnyObject): Subscription {\n    return Container.instance.get(EventAggregator).subscribeOnce(name, callback);\n  }\n  export function observe(data: AnyObject, property: string, callback: AnyObject): Subscription {\n    return Container.instance\n      .get(BindingEngine)\n      .observe(data, property)\n      .subscribe(callback);\n  }\n\n  export function createEvent<T = {}>(name: string, data?: T): CustomEvent {\n    return DOM.createCustomEvent(name, {\n      bubbles: true,\n      cancelable: true,\n      detail: data\n    });\n  }\n\n  export function fireCallbackEvent(\n    vm: AnyObject,\n    event: string,\n    data?: AnyObject\n  ): Promise<boolean> {\n    const ret = isFunction(vm[event])\n      ? vm[event](data)\n      : vm.element.dispatchEvent(UIInternal.createEvent(event, data));\n    if (ret instanceof Promise) {\n      return ret;\n    } else {\n      return Promise.resolve(ret !== false);\n    }\n  }\n\n  export function invokeLifecycle(instance, name, model?): Promise<AnyObject> {\n    if (instance && typeof instance[name] === \"function\") {\n      const result = instance[name](model);\n      if (result instanceof Promise) {\n        return result;\n      }\n      if (result !== null && result !== undefined) {\n        return Promise.resolve(result);\n      }\n      return Promise.resolve(true);\n    }\n    return Promise.resolve(true);\n  }\n\n  export function compileTemplate(tpl: string, viewModel: AnyObject = {}, bindingContext = {}): View {\n    const viewFactory = Container.instance\n      .get(ViewCompiler)\n      .compile(tpl, Container.instance.get(ViewResources));\n    const view = viewFactory.create(Container.instance);\n    view.bind(viewModel, bindingContext);\n    return view;\n  }\n}\n"],"names":["Container","TaskQueue","EventAggregator","BindingEngine","DOM","ViewCompiler","ViewResources","UIInternal"],"mappings":"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"}