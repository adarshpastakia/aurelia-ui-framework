{"version":3,"file":"ui-tab-panel.js","sources":["../../src/tab-panel/ui-tab.ts","../../src/tab-panel/ui-tab-end.ts","../../src/tab-panel/ui-tab-start.ts","../../src/tab-panel/ui-tab-panel.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { bindable, customElement, inlineView } from \"aurelia-framework\";\n\nlet tabSeed = 0;\n\n@customElement(\"ui-tab\")\n@inlineView(\n  `<template class=\"ui-tab\" data-active.bind=\"active\" data-hide.bind=\"!!view || !!viewModel\"><slot></slot></template>`\n)\nexport class UITab {\n  @bindable()\n  public id: string = \"\";\n  @bindable()\n  public label: string = \"\";\n  @bindable()\n  public icon: string = \"\";\n  @bindable()\n  public active: boolean = false;\n  @bindable()\n  public disabled: boolean = false;\n\n  @bindable()\n  public view: AnyObject;\n  @bindable()\n  public model: AnyObject;\n  @bindable()\n  public viewModel: AnyObject;\n\n  @bindable()\n  public closeable: boolean = false;\n\n  constructor(protected element: Element) {\n    this.id = `tab__${tabSeed++}`;\n  }\n\n  protected bind() {\n    this.closeable = !isFalse(this.closeable)\n  }\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-end\")\n@inlineView(`<template><div slot=\"tabbar-end\"><slot></slot></div></template>`)\nexport class UITabbarEnd {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, customElement, inlineView } from \"aurelia-framework\";\n\n@containerless()\n@customElement(\"ui-tabbar-start\")\n@inlineView(`<template><div slot=\"tabbar-start\"><slot></slot></div></template>`)\nexport class UITabbarStart {\n  constructor(protected element: Element) {}\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport {\n  autoinject,\n  bindable,\n  bindingMode,\n  children,\n  customElement,\n  DOM,\n  inlineView,\n  View\n} from \"aurelia-framework\";\nimport ResizeObserver from \"resize-observer-polyfill\";\nimport { UIInternal } from \"../utils/ui-internal\";\nimport { UITab } from \"./ui-tab\";\nimport { UITabbarEnd } from \"./ui-tab-end\";\nimport view from \"./ui-tab-panel.html\";\nimport { UITabbarStart } from \"./ui-tab-start\";\n\nexport interface UITabConfig {\n  id?: string;\n  icon?: string;\n  label?: string;\n  tooltip?: string;\n  active?: boolean;\n  disabled?: boolean;\n  closeable?: boolean;\n\n  href?: string;\n  view?: AnyObject;\n  model?: AnyObject;\n  element?: AnyObject;\n  viewModel?: AnyObject;\n}\n@autoinject()\n@customElement(\"ui-tab-panel\")\n@inlineView(view)\nclass UITabPanel {\n  @bindable()\n  public tabs: UITabConfig[] = [];\n  @bindable({ bindingMode: bindingMode.twoWay })\n  public active: string;\n\n  @bindable()\n  public align: \"top\" | \"bottom\" = \"top\";\n\n  @bindable()\n  public beforechange: () => Promise<boolean> | boolean;\n  @bindable()\n  public beforeclose: () => Promise<boolean> | boolean;\n\n  @children(\"ui-tab\")\n  protected innerTabs: UITabConfig[];\n\n  @bindable({ bindingMode: bindingMode.toView })\n  protected activeTab: UITabConfig;\n\n  private owningView: AnyObject;\n  private composeVm: AnyObject;\n\n  private wrapperEl: Element;\n  private overflowEl: Element;\n\n  private hasOverflow: boolean = false;\n  private obResize: ResizeObserver;\n\n  private isAttached: boolean = false;\n\n  constructor(protected element: Element) {\n    if (element.hasAttribute(\"no-border\")) {\n      element.classList.add(\"ui-tab__panel--noborder\");\n    }\n    this.obResize = new ResizeObserver(() => this.calculateOverflow());\n    this.obResize.observe(element);\n  }\n\n  public async activateTab(id: string): Promise<boolean> {\n    let result = true;\n    if (this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforechange\", {\n        activeTab: this.activeTab.id,\n        activeViewModel: this.composeVm.currentViewModel,\n        newTab: id\n      }).then(b => (b ? this.activate(id) : undefined));\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  public async closeTab(id: string): Promise<boolean> {\n    const tab = this.tabs.find(t => t.id === id);\n\n    let result = true;\n    if (this.activeTab.id === id && this.composeVm.currentViewModel) {\n      result = await UIInternal.invokeLifecycle(this.composeVm.currentViewModel, \"canDeactivate\");\n    }\n    if (result) {\n      return UIInternal.fireCallbackEvent(this, \"beforeclose\", tab.id).then(b =>\n        b ? this.remove(id) : false\n      );\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  // Set current owningView\n  protected created(owningView: View) {\n    this.owningView = owningView;\n  }\n\n  // Update compose owningView and viewResource to current owningView\n  protected attached(): void {\n    this.composeVm.owningView = this.owningView;\n    this.composeVm.viewResources = this.owningView.resources;\n    setTimeout(() => this.calculateOverflow(), 200);\n\n    this.isAttached = true;\n    this.tabsChanged();\n  }\n\n  protected detached(): void {\n    this.obResize.disconnect();\n  }\n\n  protected innerTabsChanged(): void {\n    this.tabs = this.innerTabs || this.tabs;\n    this.tabsChanged();\n  }\n\n  protected tabsChanged(): void {\n    if (this.isAttached) {\n      this.active = (this.tabs.find(tab => tab.active) || {}).id;\n      if (!this.active) {\n        this.activeTab = this.tabs.find(tab => !tab.disabled) || {};\n        this.active = this.activeTab.id;\n        this.activeTab.active = true;\n      }\n    }\n  }\n\n  protected activate(id: string): boolean {\n    const newTab = this.tabs.find(tab => tab.id === id);\n    if (newTab) {\n      this.element.dispatchEvent(UIInternal.createEvent(\"change\", id));\n\n      if (this.activeTab) {\n        this.activeTab.active = false;\n      }\n      this.activeTab = newTab;\n      this.active = this.activeTab.id;\n      this.activeTab.active = true;\n      return true;\n    }\n    return false;\n  }\n\n  protected remove(id: string): boolean {\n    const tab = this.tabs.find(t => t.id === id);\n    this.element.dispatchEvent(UIInternal.createEvent(\"close\", id));\n    this.tabs.splice(this.tabs.indexOf(tab), 1);\n    if (tab.element) {\n      UIInternal.queueTask(() => DOM.removeNode(tab.element));\n    }\n    return true;\n  }\n\n  protected calculateOverflow(): void {\n    this.resetOverflow();\n    const overflowItems = [];\n    const isRtl = window.getComputedStyle(this.wrapperEl).direction === \"rtl\";\n    // @ts-ignore\n    [...this.wrapperEl.children].reverse().forEach(item => {\n      if (\n        (!isRtl && this.wrapperEl.offsetWidth - (item.offsetLeft + item.offsetWidth) <= 30) ||\n        (isRtl && this.wrapperEl.offsetWidth - item.offsetLeft >= this.wrapperEl.offsetWidth - 30)\n      ) {\n        overflowItems.splice(0, 0, item);\n        this.hasOverflow = true;\n      }\n    });\n    this.overflowEl.append(...overflowItems);\n  }\n\n  protected resetOverflow(): void {\n    this.hasOverflow = false;\n    this.overflowEl.children.forEach(child => {\n      this.wrapperEl.appendChild(child);\n    });\n  }\n}\n\nexport const TabPanel = [UITabPanel, UITab, UITabbarStart, UITabbarEnd];\n"],"names":["tslib_1.__decorate","bindable","customElement","inlineView","containerless","UIInternal","DOM","tslib_1.__spread","bindingMode","children","autoinject"],"mappings":"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"}