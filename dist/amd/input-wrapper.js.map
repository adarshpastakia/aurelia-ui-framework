{"version":3,"file":"input-wrapper.js","sources":["../../src/forms/base-input.ts","../../src/forms/input-wrapper.ts"],"sourcesContent":["/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { computedFrom } from \"aurelia-framework\";\nimport { UIDrop } from \"../shared/ui-drop\";\nimport { UIInternal } from \"../utils/ui-internal\";\n\nexport class BaseInput {\n  public value: AnyObject;\n\n  protected inputEl: HTMLInputElement | HTMLTextAreaElement;\n\n  protected errors: string | string[];\n  protected maxlength: number = 0;\n  protected allowClear: boolean = false;\n  protected showCounter: boolean = false;\n\n  protected readonly: string | boolean = false;\n  protected disabled: string | boolean = false;\n  protected isDisabled: string | boolean = false;\n\n  protected dropHandle: string;\n  protected dropEl: UIDrop;\n\n  constructor(protected element: Element) {\n    this.allowClear = element.hasAttribute(\"clear\") || element.hasAttribute(\"clear.trigger\");\n    this.showCounter = element.hasAttribute(\"counter\");\n  }\n\n  public focus() {\n    this.inputEl.focus();\n  }\n\n  public disable(b: boolean): void {\n    this.isDisabled = b;\n  }\n\n  @computedFrom(\"isDisabled\", \"disabled\", \"readonly\", \"errors\", \"errors.length\")\n  get classes(): string {\n    const classes = [];\n    if (this.errors && this.errors.length > 0) {\n      classes.push(\"ui-input--invalid\");\n    }\n    if (this.isTrue(\"readonly\")) {\n      classes.push(\"ui-input--readonly\");\n    }\n    if (this.isTrue(\"disabled\") || this.isDisabled) {\n      classes.push(\"ui-input--disabled\");\n    }\n    return classes.join(\" \");\n  }\n\n  protected bind(): void {\n    this.readonly = this.isTrue(\"readonly\");\n    this.disabled = this.isTrue(\"disabled\");\n  }\n\n  protected clear(): void {\n    this.value = \"\";\n    this.inputEl.focus();\n    this.element.dispatchEvent(UIInternal.createEvent(\"clear\"));\n    this.element.dispatchEvent(UIInternal.createEvent(\"change\"));\n  }\n\n  protected fireEnter($event: KeyboardEvent): boolean {\n    if ($event.keyCode === 13) {\n      $event.stopEvent();\n      this.element.dispatchEvent(UIInternal.createEvent(\"enterpressed\", this.value));\n    }\n    return true;\n  }\n\n  protected canToggleDrop(evt: FocusEvent): void {\n    if (evt.relatedTarget && evt.relatedTarget !== this.inputEl) {\n      this.toggleDrop(false);\n    }\n  }\n\n  protected toggleDrop(open?: boolean): boolean {\n    if (open === true && this.dropEl.isOpen) {\n      UIInternal.queueMicroTask(() => this.dropEl.updatePosition());\n      return;\n    }\n    const beforeEvent = this.dropEl.isOpen && !open ? \"beforeclose\" : \"beforeopen\";\n    const afterEvent = this.dropEl.isOpen && !open ? \"close\" : \"open\";\n    if (this.element.dispatchEvent(UIInternal.createEvent(beforeEvent)) !== false) {\n      this.dropEl.toggleDrop(open);\n      this.element.dispatchEvent(UIInternal.createEvent(afterEvent));\n      if (this.dropEl.isOpen) {\n        this.inputEl.select();\n        return true;\n      } else {\n        return false;\n      }\n    }\n  }\n\n  private isTrue(prop: string): boolean {\n    return this[prop] === \"\" || this[prop] === prop || isTrue(this[prop]);\n  }\n}\n","/**\n * @author    : Adarsh Pastakia\n * @version   : 5.0.0\n * @copyright : 2019\n * @license   : MIT\n */\n\nimport { containerless, inlineView, processContent } from \"aurelia-framework\";\nimport view from \"./input-wrapper.html\";\n\n@containerless()\n@inlineView(view)\n@processContent((compiler, resources, node, instruction) => {\n  instruction.inheritBindingContext = true;\n  return true;\n})\nexport class InputWrapper {}\n"],"names":["UIInternal","__decorate","computedFrom","containerless","inlineView","processContent"],"mappings":"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"}