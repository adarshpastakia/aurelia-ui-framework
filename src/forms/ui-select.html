<template class="ui-input ${classes}" aria-disabled.bind="disabled || isDisabled" aria-readonly.bind="readonly">
  <input-wrapper model.bind="$this">
    <slot></slot>
    <div class="ui-input__tags" click.trigger="inputEl.focus()">
      <template if.bind="multiple">
        <div class="ui-tag" repeat.for="m of model">
          <span with.bind="{m}" show.one-time="buildOption(m, __el, true) & debounce" ref="__el"></span>
          <span class="ui-tag__close" click.trigger="removeValue(m)">&#x00D7;</span></div>
      </template>
      <input ref="inputEl" role="combo" size="1" placeholder.bind="placeholder" disabled.bind="disabled || isDisabled || isPlain"
        readonly.bind="readonly" value.two-way="inputValue" focus.trigger="toggleDrop(true)" blur.trigger="canToggleDrop($event)"
        input.trigger="filterOptions() & debounce" keydown.trigger="checkKeyEvent($event)" change.trigger="false" />
    </div>
  </input-wrapper>
  <ui-dropdown view-model.ref="dropEl" class="ui-list" close.trigger="resetQuery()">
    <template if.bind="innerOptions && !isGrouped">
      <div class.bind="listClass(option, value)" with.bind="{option}" repeat.for="option of innerOptions" ref="__el"
        show.one-time="buildOption(option, __el)" click.trigger="selectOption(option)" data-model.bind="option"></div>
    </template>
    <template if.bind="innerOptions && isGrouped">
      <template repeat.for="[key, options] of innerOptions">
        <div class="ui-list__title">${key}</div>
        <template repeat.for="option of options">
          <div class.bind="listClass(option, value)" with.bind="{option}" ref="__el" show.one-time="buildOption(option, __el)"
            click.trigger="selectOption(option)" data-model.bind="option"></div>
        </template>
      </template>
    </template>
    <div if.bind="isLoading" ui-padding ui-align="center" ui-font="lg" ui-color="muted">
      <ui-svg-icon icon="busy" class="ui-anim--spin"></ui-svg-icon>
    </div>
    <div if.bind="isLoaded && innerOptions.length === 0" ui-padding ui-color="muted" ui-font="sm">${noOptionsText}</div>
  </ui-dropdown>
</template>
